---
title: "HW#3"
author: "Tyler Cobian"
date: "5/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
```
load the data
```{r, include=FALSE}
data<- read_csv("HW3Data.csv")
```
1. Create a linear probability model that predicts a respondent’s probability of voting ‘yes’ on the ballot based on their age, income, NEP score, the risk reduction offered by the program, and the cost of the program to that respondent. Show the model and interpret the regression
coefficients.
```{r, results='asis'}
vote_lm<- lm(vote ~ age + income + NEP + risk + bid, data = data)
vote_lm
summary(vote_lm)

# vote = 0.1196977 + 0.0204401(age_30) -0.0201190(age_40) + 0.0099816(age_50)  -0.0162261(age_60) + 0.0027386(poor) + 0.0074891(rich) + 0.0467922(very_rich) + 0.0088282(one_percent) + 0.0158639(NEP) + 0.0007445(risk) - 0.0010699(bid)

# stargazer for the results
table_vote_lm<- stargazer(vote_lm)

```
2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths
avoided) (4% reduction in risk = 1 whale saved)

```{r}
# A 4% reduction in risk = 1 whale saved
# to find this out I am changing the risk of the 3 random people looked at in #3 and chaging the risk from 60-64
# their responding change in bid should equal their WTP for 1 whale


bid_7(60) # 446.7733
bid_7(64) # 449.5568

wtp_7<- bid_7(64) - bid_7(60)
wtp_7 #2.783438

wtp_10<- bid_10(64) - bid_10(60)
wtp_10 # 2.783438

wtp_1<- bid_1(64) - bid_1(60)
wtp_1 # 2.783438

# the overall willingness to pay for a whale in SB is 2.783438, this will be consistant among all people becasue we are using a linear model (lm) not a (glm)

```



3. Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction. 
```{r}
# not sure whos model to use but for now I will use my regression

###################
# For this portion put age, NEP, Income, risk (60), and age into the equation
# next set the equation = nd solve for the bid vlaue
# once yo have the bid value put all of the inputs into the regression eqaution and solve for vote

# if they are "middle income" put nothing in for income becasue this is the refrence value and is what all of the other incomes are compared to so its beta = 0 
##################


# risk = 0.6

# look at person "#7" and plug their info into the regression equation
# bid = ?
# NEP = 50
# income = middle
# age = 30 
# income = middle (so set = 0)

# 1 =  0.1196977 + 0.0204401*1 + 0.0158639*50 + 0.0007445*60 - 0.0010699*x

bid_7<- function(x){(0.1196977 + 0.0204401*1 + 0.0158639*50 + 0.0007445*x - 0.5)/0.0010699}
bid_7(60)

# bid = -20.56005
#######################################################
#Look at person #10
# bid = ?
# NEP = 32
# Income = poor
# age = 30
# risk = 60

# 1 = 0.1196977 + 0.0204401*1 + 0.0027386*1 + 0.0158639*32 + 0.0007445*60 - 0.0010699*x

# 1 + 0.0010699*x = 0.1196977 + 0.0204401*1 + 0.0027386*1 + 0.0158639*32 + 0.0007445*60

# x = (0.1196977 + 0.0204401*1 + 0.0027386*1 + 0.0158639*32 + 0.0007445*x - 1)/0.0010699

bid_10<- function(x){ (0.1196977 + 0.0204401*1 + 0.0027386*1 + 0.0158639*32 + 0.0007445*x - 0.5)/0.0010699}

bid_10(60)
# bid = -284.8947
###########################################################

# person 1
# bid = ?
# NEP = 15
# Income = very_rich
# age = 30
# risk = 60

# 1 = 0.1196977 + 0.0204401*1 + 0.0467922*1 + 0.0158639*15 + 0.0007445*60 - 0.0010699*x

# 1 - 0.0010699*x = 0.1196977 + 0.0204401*1 + 0.0467922*1 + 0.0158639*15 + 0.0007445*60

# x = (0.1196977 + 0.0204401*1 + 0.0467922*1 + 0.0158639*15 + 0.0007445*60 -1)/0.0010699

bid_1<- function(x){(0.1196977 + 0.0204401*1 + 0.0467922*1 + 0.0158639*15 + 0.0007445*x -0.5)/0.0010699}

bid_1(60)
# bid = -485.7861
```
4. Now repeat this process and estimate the mean WTP for a VSR program offering 60% risk reduction among Santa Barbara County households.

```{r}
# take the average amonst all of the values, average NEP, average income = median, have to see the mode of age levels to see what age bracket has the most people in it then use that age braket for the averge. 
# create a equation for bid using these values and find the bid value for a 60% reduction

# make a table of the averages


  

  
  









```
















