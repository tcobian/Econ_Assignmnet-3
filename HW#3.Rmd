---
title: "HW#3"
author: "Tyler Cobian"
date: "5/15/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(stargazer)
```
load the data
```{r, include=FALSE}
data<- read_csv("HW3Data.csv")
```
1. Create a linear probability model that predicts a respondent’s probability of voting ‘yes’ on the ballot based on their age, income, NEP score, the risk reduction offered by the program, and the cost of the program to that respondent. Show the model and interpret the regression
coefficients.
```{r, results='asis'}
vote_lm<- lm(vote ~ age + income + NEP + risk + bid, data = data)
vote_lm
summary(vote_lm)

# vote = 0.1196977 + 0.0204401(age_30) -0.0201190(age_40) + 0.0099816(age_50)  -0.0162261(age_60) + 0.0027386(poor) + 0.0074891(rich) + 0.0467922(very_rich) + 0.0088282(one_percent) + 0.0158639(NEP) + 0.0007445(risk) - 0.0010699(bid)

# stargazer for the results
table_vote_lm<- stargazer(vote_lm)

```
2. Based on this regression, what can you say about the value of a single prevented whale death? (Hint: Think about how risk reduction for all whales translates into the number of whale deaths
avoided)


3. Pick three arbitrary respondents. For each of those respondents, estimate their WTP for a VSR program offering 60% risk reduction. 
```{r}
# not sure whos model to use but for now I will use my regression

# risk = 0.6

# look at person "#7" and plug their info into the regression equation
# bid = 20 <- not sure how to find the bid value for a 60% reduction
# NEP = 50
# income = middle
# age = 30 
# income = middle <- for some reason the middle income beta is not showing                      up in my regression not sure why, for now I will                           state that this participant is "poor"

p_7<- function(x){0.1196977 + 0.0204401*1 + 0.0027386*1 + 0.0158639*50 + 0.0007445*x - 0.0010699*20}

p_7(60)
# 0.9593434 <- I think this is this persons probability to vote for the program

#Look at person #10
# bid = 40
# NEO = 32
# Income = poor
# age = 30
# risk = 60

p_10<- function(x){ 0.1196977 + 0.0204401*1 + 0.0027386*1 + 0.0158639*32 + 0.0007445*x - 0.0010699*40}

p_10(60)
# 0.6523952

















```
















